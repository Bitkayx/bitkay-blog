---
import Layout from "../../layouts/Layout.astro";

const allPosts = Object.values(
  import.meta.glob("../posts/*.md", { eager: true }),
);

const tagCounts: Record<string, number> = {};
allPosts.forEach((post: any) => {
  if (post.frontmatter.tags) {
    post.frontmatter.tags.forEach((tag: string) => {
      tagCounts[tag] = (tagCounts[tag] || 0) + 1;
    });
  }
});

const tags = Object.entries(tagCounts)
  .map(([tag, count]) => ({ tag, count }))
  .sort((a, b) => b.count - a.count);
---

<Layout title="Etiquetas">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <section class="text-center mb-12">
      <h1 class="text-4xl font-light mb-4">Etiquetas</h1>
      <p class="text-slate-600 dark:text-slate-400 text-lg">
        Explora {tags.length} etiquetas en {allPosts.length} publicaciones
      </p>
    </section>

    <section
      class="bg-slate-50 dark:bg-slate-800 rounded-lg p-8 border border-slate-200 dark:border-slate-700"
    >
      <div class="flex flex-wrap gap-2 justify-center items-center">
        {
          tags.map(({ tag, count }) => {
            const sizeClass =
              count >= 4
                ? "text-2xl font-bold"
                : count === 3
                  ? "text-xl font-semibold"
                  : count === 2
                    ? "text-lg font-medium"
                    : "text-base";
            const opacity =
              count >= 4
                ? "opacity-100"
                : count === 3
                  ? "opacity-90"
                  : count === 2
                    ? "opacity-80"
                    : "opacity-60";

            return (
              <a
                href={`/tags/${tag}`}
                class={`${sizeClass} ${opacity} text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-100 transition-all duration-200 hover:scale-110 transform-gpu`}
              >
                {tag}
              </a>
            );
          })
        }
      </div>
    </section>
  </div>
</Layout>
